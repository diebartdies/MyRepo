# -----------------------------------------------
# Docker Mailserver Configuration
# mailserver.env
# -----------------------------------------------

# ===============================================
# REQUIRED: Basic Server Configuration
# ===============================================

# Hostname for the mail server (FQDN - Fully Qualified Domain Name)
OVERRIDE_HOSTNAME=mail.drsrv.net.ar

# Domain name for the mail server
DOMAINNAME=drsrv.net.ar

# Postmaster email address (receives system notifications)
POSTMASTER_ADDRESS=postmaster@drsrv.net.ar

# ===============================================
# SSL/TLS Configuration
# ===============================================

# SSL Type: letsencrypt | manual | self-signed | custom | ""
# - letsencrypt: Automatically use Let's Encrypt certificates
# - manual: Use your own certificates (specify paths below)
# - self-signed: Generate self-signed certificates (testing only)
# - "": Disable SSL (NOT RECOMMENDED)
SSL_TYPE=manual

# Paths to SSL certificates (if SSL_TYPE=manual)
SSL_CERT_PATH=/tmp/ssl/cert.pem
SSL_KEY_PATH=/tmp/ssl/key.pem

# SSL domain (if different from DOMAINNAME)
SSL_DOMAIN=mail.drsrv.net.ar

# TLS security level: modern | intermediate | old | may
# - modern: Only TLS 1.3+ (most secure, may break old clients)
# - intermediate: TLS 1.2+ (recommended)
# - may: Opportunistic TLS (allow unencrypted)
TLS_LEVEL=intermediate

# ===============================================
# Email Account Settings
# ===============================================

# Enable IMAP protocol (recommended)
ENABLE_IMAP=1

# Enable POP3 protocol (usually not needed)
ENABLE_POP3=0

# Enable ManageSieve protocol (for mail filtering rules)
ENABLE_MANAGESIEVE=0

# ===============================================
# Spam and Virus Protection
# ===============================================

# Enable Rspamd (modern spam filter - RECOMMENDED)
# Replaces SpamAssassin with better performance
ENABLE_RSPAMD=1

# Enable SpamAssassin (legacy spam filter)
# Don't enable both Rspamd and SpamAssassin
ENABLE_SPAMASSASSIN=0

# Enable ClamAV antivirus scanning
# WARNING: Requires 2GB+ RAM
ENABLE_CLAMAV=0

# Enable Amavis (mail content filter)
ENABLE_AMAVIS=0

# Move spam to Junk folder automatically
MOVE_SPAM_TO_JUNK=1

# Spam subject prefix
#SPAM_SUBJECT=[SPAM]

# ===============================================
# Security Features
# ===============================================

# Enable Fail2Ban (blocks brute force attacks)
ENABLE_FAIL2BAN=1

# Enable Postgrey (greylisting - delays suspicious emails)
ENABLE_POSTGREY=0

# Spoof protection (reject mail claiming to be from your domain)
SPOOF_PROTECTION=1

# Enable DKIM signing (recommended for deliverability)
ENABLE_OPENDKIM=1

# Enable DMARC checks
ENABLE_OPENDMARC=1

# Enable SPF checks
ENABLE_POLICYD_SPF=1

# ===============================================
# Network and Access Control
# ===============================================

# Which networks can send mail without authentication
# none = No networks (recommended)
# connected-networks = Docker networks
# host = Host machine
PERMIT_DOCKER=host

# Networks allowed to relay (comma-separated)
#RELAY_HOST=smtp.gmail.com:587
#RELAY_USER=your-email@gmail.com
#RELAY_PASSWORD=your-app-password

# ===============================================
# Logging
# ===============================================

# Log level: error | warn | info | debug | trace
LOG_LEVEL=info

# Supervisor log level
SUPERVISOR_LOGLEVEL=warn

# ===============================================
# Postfix Configuration
# ===============================================

# Message size limit (bytes) - 10MB default
POSTFIX_MESSAGE_SIZE_LIMIT=10240000

# Mailbox size limit (0 = unlimited)
POSTFIX_MAILBOX_SIZE_LIMIT=0

# Virtual mailbox size limit
#POSTFIX_VIRTUAL_MAILBOX_LIMIT=0

# Reject unknown recipient domains
POSTFIX_REJECT_UNKNOWN_CLIENT_HOSTNAME=0

# ===============================================
# Dovecot Configuration
# ===============================================

# Mailbox format: maildir | sdbox | mdbox
DOVECOT_MAILBOX_FORMAT=maildir

# Enable Dovecot master users (admin login as any user)
#ENABLE_DOVECOT_MASTER_USER=0

# ===============================================
# SASLAuthd (Authentication)
# ===============================================

# Enable SASLAuthd
ENABLE_SASLAUTHD=0

# SASLAuthd mechanisms: ldap | shadow | mysql | pam
#SASLAUTHD_MECHANISMS=shadow

# LDAP configuration (if using LDAP authentication)
#SASLAUTHD_LDAP_SERVER=ldap.drsrv.net.ar
#SASLAUTHD_LDAP_BIND_DN=cn=admin,dc=example,dc=com
#SASLAUTHD_LDAP_PASSWORD=password
#SASLAUTHD_LDAP_SEARCH_BASE=ou=users,dc=example,dc=com
#SASLAUTHD_LDAP_FILTER=(&(objectClass=person)(mail=%U))

# ===============================================
# LDAP Integration (Optional)
# ===============================================

# Enable LDAP for email accounts
#ENABLE_LDAP=0
#LDAP_SERVER_HOST=ldap.drsrv.net.ar
#LDAP_BIND_DN=cn=admin,dc=example,dc=com
#LDAP_BIND_PW=password
#LDAP_SEARCH_BASE=ou=users,dc=example,dc=com
#LDAP_QUERY_FILTER_USER=(&(objectClass=inetOrgPerson)(mail=%s))

# ===============================================
# OAuth2 (Optional)
# ===============================================

# Enable OAuth2
#ENABLE_OAUTH2=0
#OAUTH2_INTROSPECTION_URL=https://oauth.provider.com/introspect

# ===============================================
# Fetchmail (Retrieve mail from other servers)
# ===============================================

# Enable fetchmail
#ENABLE_FETCHMAIL=0

# Fetchmail poll interval (seconds)
#FETCHMAIL_POLL=300

# ===============================================
# Getmail (Alternative to fetchmail)
# ===============================================

# Enable getmail
#ENABLE_GETMAIL=0

# ===============================================
# Quota Management
# ===============================================

# Enable quotas
ENABLE_QUOTAS=1

# Default quota (empty = no limit)
#QUOTA_MESSAGE_LIMIT=10000
#QUOTA_STORAGE_LIMIT=10G

# ===============================================
# Update Check
# ===============================================

# Check for updates (sends anonymous statistics)
UPDATE_CHECK_INTERVAL=1d

# ===============================================
# Advanced Settings
# ===============================================

# Enable POP3 over TLS
#ENABLE_POP3_TLS=1

# Enable submission port 587
#ENABLE_SUBMISSION=1

# Account provisioning source: FILE | LDAP | OIDC
ACCOUNT_PROVISIONER=FILE

# One directory per user (recommended for large setups)
ONE_DIR=1

# Enable SRS (Sender Rewriting Scheme) for forwarding
#ENABLE_SRS=0

# Dovecot password scheme: PLAIN | SHA512-CRYPT | BLF-CRYPT
DOVECOT_PASS_SCHEME=SHA512-CRYPT

# ===============================================
# Debugging
# ===============================================

# Enable debugging
#DMS_DEBUG=0

# Verbose logging for specific services
#LOGWATCH_INTERVAL=none
LOGROTATE_INTERVAL=weekly

TZ=America/Argentina/Buenos_Aires

# ===============================================
# Notes
# ===============================================
#
# 1. Change mail.drsrv.net.ar to your actual mail server hostname
# 2. Change drsrv.net.ar to your actual domain
# 3. Generate SSL certificates and place in ./certs/ directory
# 4. Uncomment and configure RELAY_* if sending through another SMTP server
# 5. ClamAV requires significant RAM (2GB+), disable if limited resources
# 6. Use Rspamd OR SpamAssassin, not both
# 7. Create email accounts with: ./setup.sh email add user@drsrv.net.ar password
#
# Documentation: https://docker-mailserver.github.io/docker-mailserver/latest/